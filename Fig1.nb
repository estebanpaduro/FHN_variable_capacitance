(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     43636,        977]
NotebookOptionsPosition[     42958,        957]
NotebookOutlinePosition[     43456,        976]
CellTagsIndexPosition[     43413,        973]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "notebook", " ", "is", " ", "used", " ", "to", " ", 
     "generate", " ", "figure", " ", "1", " ", "in", " ", "the", " ", 
     "article", "\[IndentingNewLine]", 
     "\"\<Analysis of Neural Activation in Time-dependent Membrane \
Capacitance Models\>\"", " ", "by", " ", "\[IndentingNewLine]", "Courdurier", 
     " ", 
     RowBox[{"M", "."}]}], " ", ",", " ", 
    RowBox[{"Medina", " ", 
     RowBox[{"L", ".", " ", "E", ".", " ", "and"}], " ", "Paduro", " ", 
     RowBox[{"E", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C0", "=", "1"}], ";", 
    RowBox[{"C1", "=", "0.6"}], ";", 
    RowBox[{"C2", "=", "0.35"}], ";", 
    RowBox[{"C3", "=", "0.2"}], ";", 
    RowBox[{"\[Tau]2", "=", "0.4"}], ";", 
    RowBox[{"\[Tau]1", "=", 
     RowBox[{"\[Tau]2", "-", "\[Delta]"}]}], ";", 
    RowBox[{"\[Tau]3", "=", 
     RowBox[{"1", "-", "\[Delta]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"FHN", " ", "Parameters"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ep", "=", "0.08"}], ";", 
    RowBox[{"\[Beta]", "=", "0.65"}], ";", 
    RowBox[{"\[Gamma]", "=", "0.7"}], ";", 
    RowBox[{"maxtime", "=", "570"}], ";", 
    RowBox[{"\[Omega]1", "=", "0.5"}], ";", 
    RowBox[{"\[Omega]2", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t1", "=", "20"}], ";", 
    RowBox[{"t2", "=", "40"}], ";", 
    RowBox[{"t3", "=", "60"}], ";", 
    RowBox[{"t4", "=", "80"}], ";", 
    RowBox[{"t5", "=", "100"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t6", "=", "120"}], ";", 
    RowBox[{"t7", "=", "135"}], ";", 
    RowBox[{"t8", "=", "150"}], ";", 
    RowBox[{"t9", "=", "165"}], ";", 
    RowBox[{"t10", "=", "175"}], ";", 
    RowBox[{"t11", "=", "210"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t12", "=", "211"}], ";", 
    RowBox[{"t13", "=", "250"}], ";", 
    RowBox[{"t14", "=", "251"}], ";", 
    RowBox[{"t15", "=", "280"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t16", "=", "281"}], ";", 
    RowBox[{"t17", "=", "300"}], ";", 
    RowBox[{"t18", "=", "301"}], ";", 
    RowBox[{"t19", "=", "320"}], ";", 
    RowBox[{"t20", "=", "350"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t21", "=", 
     RowBox[{"t20", "+", 
      RowBox[{"8", "*", "2", 
       RowBox[{"Pi", "/", "\[Omega]1"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t22", "=", "470"}], ";", 
    RowBox[{"t23", "=", 
     RowBox[{"t22", "+", 
      RowBox[{"30", "*", "2", 
       RowBox[{"Pi", "/", "\[Omega]2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t24", "=", "550"}], ";", 
    RowBox[{"t25", "=", "560"}], ";", 
    RowBox[{"t26", "=", "570"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Ct", "[", "t_", "]"}], "=", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t", "<", "t1"}], ",", "C0", ",", "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t2"}], ",", 
       RowBox[{"C0", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"t", "-", "t1"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"t2", "-", "t1"}], ")"}]}], 
         RowBox[{"(", 
          RowBox[{"C3", "-", "C0"}], ")"}]}]}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t3"}], ",", "C3", ",", "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t4"}], ",", 
       RowBox[{"C3", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"t", "-", "t3"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"t4", "-", "t3"}], ")"}]}], 
         RowBox[{"(", 
          RowBox[{"C0", "-", "C3"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t5"}], ",", "C0", ",", "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t6"}], ",", "0.7", ",", "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t7"}], ",", "0.4", ",", "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t8"}], ",", "0.55", ",", "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t9"}], ",", "0.65", ",", "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t10"}], ",", "0.8", ",", "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t11"}], ",", "C0", ",", "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t12"}], ",", 
       RowBox[{"C0", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"t", "-", "t11"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"t12", "-", "t11"}], ")"}]}], 
         RowBox[{"(", 
          RowBox[{"C2", "-", "C0"}], ")"}]}]}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t13"}], ",", "C2", ",", "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t14"}], ",", 
       RowBox[{"C2", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"t", "-", "t13"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"t14", "-", "t13"}], ")"}]}], 
         RowBox[{"(", 
          RowBox[{"C0", "-", "C2"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t15"}], ",", "C0", ",", "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t16"}], ",", 
       RowBox[{"C0", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"t", "-", "t15"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"t16", "-", "t15"}], ")"}]}], 
         RowBox[{"(", 
          RowBox[{"C1", "-", "C0"}], ")"}]}]}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t17"}], ",", "C1", ",", "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t18"}], ",", 
       RowBox[{"C1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"t", "-", "t17"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"t18", "-", "t17"}], ")"}]}], 
         RowBox[{"(", 
          RowBox[{"C0", "-", "C1"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t19"}], ",", "C0", ",", "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t20"}], ",", 
       RowBox[{"C0", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"t", "-", "t19"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"t20", "-", "t19"}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{"C1", "-", "C0"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t21"}], ",", 
       RowBox[{"C1", " ", "+", " ", 
        RowBox[{"0.3", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Omega]1", 
           RowBox[{"(", 
            RowBox[{"t", "-", "t20"}], ")"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t22"}], ",", "C1", ",", "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t23"}], ",", 
       RowBox[{"C1", " ", "+", " ", 
        RowBox[{"0.3", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Omega]2", 
           RowBox[{"(", 
            RowBox[{"t", "-", "t22"}], ")"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t24"}], ",", "C1", ",", "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t25"}], ",", 
       RowBox[{"C1", "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"t", "-", "t24"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"t25", "-", "t24"}], ")"}]}], 
         RowBox[{"(", 
          RowBox[{"C0", "-", "C1"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"t", "<", "t26"}], ",", "C0", ",", "\[IndentingNewLine]", 
       "True", ",", "1"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Compute", " ", "equilibrium"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqn", "=", 
     RowBox[{"FindRoot", "[", 
      RowBox[{
       RowBox[{"0", "==", 
        RowBox[{"v", "-", 
         RowBox[{
          RowBox[{"v", "^", "3"}], "/", "3"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"v", "+", "\[Beta]"}], ")"}], "/", "\[Gamma]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"v", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v0", ",", "w0"}], "}"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"v", "+", "\[Beta]"}], ")"}], "/", "\[Gamma]"}]}], "}"}], "/.",
       "eqn"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.9041566281048536`*^9, {3.904156675673607*^9, 3.904156677227667*^9}, {
   3.90415718156781*^9, 3.9041571817962613`*^9}, {3.9041575367701483`*^9, 
   3.9041575627212887`*^9}, {3.904157654850972*^9, 3.904157702008526*^9}, {
   3.9041620412730384`*^9, 3.904162144012695*^9}, {3.9041622342590394`*^9, 
   3.90416227648479*^9}, {3.90416237263253*^9, 3.9041623847076178`*^9}, {
   3.9046623531859703`*^9, 3.9046623534529824`*^9}, {3.904664903126735*^9, 
   3.904664904063896*^9}, {3.9046653521024547`*^9, 3.90466535219632*^9}, {
   3.905255967446809*^9, 3.9052559679638877`*^9}, {3.905257844140292*^9, 
   3.905257844453767*^9}, {3.9211647229877353`*^9, 3.9211647278628387`*^9}, {
   3.921164818508169*^9, 3.92116483588235*^9}, {3.9211655706532745`*^9, 
   3.9211655707209454`*^9}, {3.921165623603587*^9, 3.921165623667091*^9}, {
   3.921168321049449*^9, 3.9211683673768716`*^9}, {3.9211684192602825`*^9, 
   3.9211685067362146`*^9}, {3.9211687900219297`*^9, 3.92116879061071*^9}, {
   3.921168851918314*^9, 3.9211688520922823`*^9}, {3.921168991377681*^9, 
   3.9211689929903994`*^9}, {3.9211690244247117`*^9, 3.9211690567364564`*^9}, 
   3.921169089318722*^9, {3.9211692864628687`*^9, 3.9211693203482895`*^9}, {
   3.9211693529951506`*^9, 3.9211693598762665`*^9}, {3.9211694926126757`*^9, 
   3.921169578709119*^9}, {3.921169613829138*^9, 3.921169614084813*^9}, {
   3.921339748306013*^9, 3.921339774335105*^9}, {3.9213398171556606`*^9, 
   3.921339818968194*^9}, {3.9391305644403815`*^9, 3.9391305943340473`*^9}, {
   3.9391306784048157`*^9, 3.9391306964390764`*^9}, {3.939130853454879*^9, 
   3.939131059960845*^9}, {3.9391328318455877`*^9, 3.939132836225188*^9}, {
   3.939133815123722*^9, 3.9391338154282722`*^9}, {3.9391343868791313`*^9, 
   3.939134414576773*^9}, {3.940930243547008*^9, 3.940930276293557*^9}, {
   3.9409304022735634`*^9, 3.9409304385711727`*^9}, {3.9409305424442425`*^9, 
   3.9409307748369713`*^9}, {3.9409308256670156`*^9, 3.940931023091076*^9}, {
   3.940931084297303*^9, 3.9409311808937335`*^9}, {3.940931226705214*^9, 
   3.9409312927510977`*^9}, {3.940931354261217*^9, 3.9409313618418307`*^9}, {
   3.9409317862584205`*^9, 3.9409317862983475`*^9}, {3.940939743880456*^9, 
   3.940939865045413*^9}, {3.9409429922607594`*^9, 3.9409431544116917`*^9}, {
   3.940943476924554*^9, 3.9409434797208996`*^9}, {3.9409435519458685`*^9, 
   3.940943564675231*^9}, {3.940943617876973*^9, 3.940943645935676*^9}, {
   3.9409437342509003`*^9, 3.940943936551631*^9}, {3.9409439670774107`*^9, 
   3.9409439823708825`*^9}, {3.940944014950638*^9, 3.9409440325975275`*^9}, {
   3.9409441561536264`*^9, 3.940944177913703*^9}, {3.9409442141895957`*^9, 
   3.9409443909383383`*^9}, {3.9409444418305693`*^9, 3.940944480517776*^9}, {
   3.9409448722461395`*^9, 3.9409449204316797`*^9}, {3.9409449889587617`*^9, 
   3.9409450391861725`*^9}, {3.9409450754553976`*^9, 
   3.9409451055199623`*^9}, {3.9409451542968407`*^9, 
   3.9409451768691645`*^9}, {3.9409453015968404`*^9, 
   3.9409453233673406`*^9}, {3.9409454007426596`*^9, 
   3.9409454731755815`*^9}, {3.940945515298504*^9, 3.94094553849819*^9}, {
   3.940945601894397*^9, 3.9409456021429853`*^9}, {3.9409457374550905`*^9, 
   3.9409457674886646`*^9}, {3.940946023569461*^9, 3.94094612749313*^9}, {
   3.9409461757737694`*^9, 3.9409462636061096`*^9}, {3.9409463584838853`*^9, 
   3.9409463620621595`*^9}, {3.9409463983705044`*^9, 3.940946482187752*^9}, 
   3.940946540404894*^9, {3.9409465707961407`*^9, 3.9409465922584667`*^9}, {
   3.9409468098763533`*^9, 3.940946810237115*^9}, {3.9409468419931917`*^9, 
   3.9409468421979074`*^9}, {3.9409469786131783`*^9, 3.940946982515177*^9}, {
   3.940947062529766*^9, 3.940947079274126*^9}, {3.9409471231199894`*^9, 
   3.940947123211467*^9}, {3.941734377720664*^9, 3.9417343801390924`*^9}, {
   3.9417351310363073`*^9, 3.9417351468743744`*^9}, {3.944210612890626*^9, 
   3.944210781747188*^9}, {3.944210824776664*^9, 3.9442109314127684`*^9}, {
   3.944210966701558*^9, 3.9442110200876217`*^9}, {3.9442112713332667`*^9, 
   3.944211376939539*^9}, {3.9442114143008184`*^9, 3.9442115846016645`*^9}, {
   3.944211819113668*^9, 3.944211819177114*^9}, {3.944213489549943*^9, 
   3.9442134896338387`*^9}, {3.9442170314425373`*^9, 3.944217082593189*^9}, {
   3.944217116531641*^9, 3.944217126246804*^9}, {3.9442172718120046`*^9, 
   3.9442172726384335`*^9}, {3.944217338152604*^9, 3.944217341000183*^9}, {
   3.944228285081162*^9, 3.9442283163883066`*^9}, {3.944554798205885*^9, 
   3.9445548318996315`*^9}, {3.9445548732043924`*^9, 
   3.9445549146016235`*^9}, {3.9445549744858065`*^9, 3.944554989411417*^9}, {
   3.9445550302343674`*^9, 3.9445550325602684`*^9}, {3.9445550749641066`*^9, 
   3.9445550822756824`*^9}, {3.9445555535929866`*^9, 3.944555565289013*^9}, {
   3.944555607249405*^9, 3.944555669948948*^9}, {3.944555891658657*^9, 
   3.9445559178290744`*^9}, {3.944561020123376*^9, 3.944561046188878*^9}, {
   3.9445732849416065`*^9, 3.9445732988282394`*^9}, {3.9445735664048595`*^9, 
   3.94457356664178*^9}, {3.9445736359894714`*^9, 3.9445736363187127`*^9}, {
   3.9445736687393255`*^9, 3.9445737389893003`*^9}, {3.944573795949021*^9, 
   3.9445738048600225`*^9}, {3.944574409954751*^9, 3.9445744100209017`*^9}, {
   3.944574579813572*^9, 3.944574719538392*^9}, {3.944574800454136*^9, 
   3.9445748005061274`*^9}, {3.9445751809290905`*^9, 3.944575183391898*^9}, 
   3.9470612160730963`*^9, {3.947061249218274*^9, 3.9470612492494946`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"6add7b26-39a8-4826-b72b-5aaa68dd0471"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Simulation", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"U1", ",", "W1"}], "}"}], "=", 
    RowBox[{"NDSolveValue", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"u", "'"}], "[", "t", "]"}], " ", "==", 
         RowBox[{
          RowBox[{
           RowBox[{"u", "[", "t", "]"}], "/", 
           RowBox[{"Ct", "[", "t", "]"}]}], "-", 
          RowBox[{
           RowBox[{
            RowBox[{"u", "[", "t", "]"}], "^", "3"}], "/", 
           RowBox[{"(", 
            RowBox[{"3", 
             RowBox[{
              RowBox[{"Ct", "[", "t", "]"}], "^", "3"}]}], ")"}]}], "-", 
          RowBox[{"w", "[", "t", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"w", "'"}], "[", "t", "]"}], "==", 
         RowBox[{"ep", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"u", "[", "t", "]"}], "/", 
             RowBox[{"Ct", "[", "t", "]"}]}], "-", 
            RowBox[{"\[Gamma]", " ", 
             RowBox[{"w", "[", "t", "]"}]}], " ", "+", " ", "\[Beta]"}], 
           ")"}]}]}], ",", 
        RowBox[{
         RowBox[{"u", "[", "0", "]"}], "==", 
         RowBox[{
          RowBox[{"Ct", "[", "0", "]"}], "v0"}]}], ",", 
        RowBox[{
         RowBox[{"w", "[", "0", "]"}], "==", "w0"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"u", ",", "w"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "maxtime"}], "}"}], ",", 
      RowBox[{"MaxStepSize", "->", "0.006"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.9046590429531374`*^9, 3.904659055468788*^9}, 
   3.9046590954624987`*^9, {3.9046591500618753`*^9, 3.9046591518650227`*^9}, {
   3.9046607619549603`*^9, 3.904660764649745*^9}, {3.904660863312126*^9, 
   3.9046608668924713`*^9}, {3.904660914496625*^9, 3.9046610591128826`*^9}, {
   3.9052556878832397`*^9, 3.9052556918546886`*^9}, {3.905255757690468*^9, 
   3.905255786731265*^9}, {3.9052558251745777`*^9, 3.9052558687138033`*^9}, {
   3.9052559157699995`*^9, 3.90525593325875*^9}, {3.9052560188971677`*^9, 
   3.9052560195609903`*^9}, {3.905256080118847*^9, 3.9052560829857235`*^9}, {
   3.9052561191791315`*^9, 3.9052561202490396`*^9}, {3.9052561529145203`*^9, 
   3.905256158083002*^9}, {3.9211655884344406`*^9, 3.9211655888832607`*^9}, {
   3.921165646229005*^9, 3.921165727408249*^9}, {3.921165804285595*^9, 
   3.9211658211911387`*^9}, {3.921168383761577*^9, 3.9211683869852805`*^9}, {
   3.921168742075246*^9, 3.9211687614350147`*^9}, {3.9211691565576663`*^9, 
   3.921169163655249*^9}, {3.921169431388242*^9, 3.9211694341829576`*^9}, {
   3.9211694648783817`*^9, 3.9211694833931503`*^9}, 3.921169531079606*^9, {
   3.921169624458933*^9, 3.921169627016403*^9}, 3.921339856632168*^9, {
   3.939132440692341*^9, 3.939132446799162*^9}, {3.9391324795620565`*^9, 
   3.9391324930425315`*^9}, {3.939132553748233*^9, 3.939132652320591*^9}, 
   3.9391330800434875`*^9, {3.940943215198682*^9, 3.940943331736098*^9}, {
   3.9409435029554195`*^9, 3.9409435178529906`*^9}, {3.9409440599564466`*^9, 
   3.9409440730291424`*^9}, {3.9409448183593206`*^9, 
   3.9409448321725245`*^9}, {3.9409461707724333`*^9, 3.940946172731908*^9}, {
   3.9409472399021153`*^9, 3.9409472491251516`*^9}, {3.9410344351158743`*^9, 
   3.9410344398465433`*^9}, {3.941726438502908*^9, 3.9417264662886906`*^9}, {
   3.9417265659245863`*^9, 3.941726566002375*^9}, {3.9417266662106895`*^9, 
   3.9417267076395125`*^9}, {3.9417267660829725`*^9, 
   3.9417267684514437`*^9}, {3.9417267993204746`*^9, 
   3.9417268164409447`*^9}, {3.9417268978789463`*^9, 
   3.9417269012994485`*^9}, {3.9417269665005717`*^9, 3.941726966809372*^9}, {
   3.9417269976150494`*^9, 3.941727002944417*^9}, {3.941727086415198*^9, 
   3.9417270956703343`*^9}, {3.9417272628150897`*^9, 
   3.9417273211839695`*^9}, {3.941727351549362*^9, 3.941727379015086*^9}, {
   3.9417275670485115`*^9, 3.9417276163104124`*^9}, {3.941727684500493*^9, 
   3.94172769811609*^9}, {3.941727729183671*^9, 3.941727772314251*^9}, {
   3.9417278209785156`*^9, 3.9417278365446696`*^9}, {3.9417278745028467`*^9, 
   3.9417278746016636`*^9}, {3.9417281349787617`*^9, 3.9417281449086523`*^9}, 
   3.9417282189971514`*^9, {3.941728320197575*^9, 3.941728320397577*^9}, {
   3.941728688507739*^9, 3.941728762254311*^9}, {3.941728917123612*^9, 
   3.94172896890866*^9}, {3.9417290842323494`*^9, 3.9417290848431787`*^9}, 
   3.9417291321365023`*^9, {3.941729318547779*^9, 3.9417293362270803`*^9}, {
   3.941729399892007*^9, 3.9417294042024117`*^9}, {3.9417294415036983`*^9, 
   3.941729458576234*^9}, {3.941729546451874*^9, 3.9417295568273935`*^9}, {
   3.9417296560213685`*^9, 3.9417297078678513`*^9}, {3.9417297801813593`*^9, 
   3.9417297831351624`*^9}, {3.9417298147167263`*^9, 3.941729824225791*^9}, {
   3.941730416389488*^9, 3.941730532740239*^9}, {3.941730916708701*^9, 
   3.941730921964011*^9}, {3.9417309641426125`*^9, 3.941730969104912*^9}, 
   3.941731250996154*^9, {3.941731290090628*^9, 3.941731301897846*^9}, 
   3.941731406239767*^9, {3.9417316208309135`*^9, 3.941731656222804*^9}, {
   3.9417317000731096`*^9, 3.941731786363027*^9}, {3.941731826103546*^9, 
   3.9417318922034917`*^9}, {3.941731963438285*^9, 3.9417319694512744`*^9}, {
   3.941732010404538*^9, 3.941732047127643*^9}, {3.941732078767626*^9, 
   3.941732080029647*^9}, {3.941732118073661*^9, 3.9417321544853487`*^9}, {
   3.9417323862595987`*^9, 3.9417324031677837`*^9}, {3.9417324700469756`*^9, 
   3.941732483205449*^9}, {3.9417325352089477`*^9, 3.9417325362253385`*^9}, {
   3.9417325880902543`*^9, 3.941732589535857*^9}, {3.941732682894351*^9, 
   3.9417327083440256`*^9}, {3.941732740837542*^9, 3.941732771716735*^9}, {
   3.9417329505597944`*^9, 3.9417329512324357`*^9}, {3.9417329873131084`*^9, 
   3.9417329921345425`*^9}, {3.9417331346600485`*^9, 
   3.9417331347292805`*^9}, {3.941733322642577*^9, 3.9417333598878765`*^9}, {
   3.941733617333274*^9, 3.941733717674321*^9}, {3.94173385857755*^9, 
   3.941734196913679*^9}, {3.941734253382819*^9, 3.9417342717909966`*^9}, {
   3.941734915112602*^9, 3.941734916060066*^9}, {3.941735049714386*^9, 
   3.9417350847255116`*^9}, {3.9417351960152617`*^9, 
   3.9417352009853992`*^9}, {3.941736288923653*^9, 3.9417362969838514`*^9}, {
   3.9417364250372577`*^9, 3.9417364251165886`*^9}, {3.944211838043586*^9, 
   3.9442119627031193`*^9}, {3.9442120298518295`*^9, 3.944212054481906*^9}, {
   3.94421210358257*^9, 3.9442121926322403`*^9}, {3.9442122241765547`*^9, 
   3.944212239875105*^9}, {3.9442123435255375`*^9, 3.944212352723466*^9}, {
   3.9442124071803675`*^9, 3.9442124081419926`*^9}, {3.9442125667793336`*^9, 
   3.9442129053760185`*^9}, {3.9442129471579914`*^9, 
   3.9442129495202365`*^9}, {3.9442129882712507`*^9, 3.944212993019435*^9}, {
   3.944213109507537*^9, 3.944213111050073*^9}, {3.944213161787146*^9, 
   3.9442131854804616`*^9}, {3.9442132857931647`*^9, 
   3.9442133271436076`*^9}, {3.9442133777026544`*^9, 
   3.9442134273133802`*^9}, {3.9442135800542803`*^9, 3.9442136425249586`*^9}, 
   3.944213736086154*^9, 3.944213937285698*^9, {3.944214150552593*^9, 
   3.9442141592714753`*^9}, {3.9442142937068357`*^9, 3.944214294230624*^9}, {
   3.944214390224277*^9, 3.9442143987180176`*^9}, {3.944214484790069*^9, 
   3.944214506161799*^9}, {3.94421454680408*^9, 3.944214569455744*^9}, {
   3.9442146155304427`*^9, 3.9442146186407948`*^9}, {3.944214650958054*^9, 
   3.944214674040207*^9}, {3.9442156967862206`*^9, 3.9442157039619913`*^9}, {
   3.9442158825047827`*^9, 3.9442159203655777`*^9}, {3.9442160120023527`*^9, 
   3.944216135245042*^9}, {3.9442161748148556`*^9, 3.9442161929949284`*^9}, {
   3.944216378576236*^9, 3.9442163939663343`*^9}, {3.9442164308982115`*^9, 
   3.9442164518519373`*^9}, {3.9442164891761627`*^9, 
   3.9442165592281895`*^9}, {3.9442165952484818`*^9, 
   3.9442166321652503`*^9}, {3.9442166702049003`*^9, 
   3.9442167108100944`*^9}, {3.944216753625902*^9, 3.9442168732774982`*^9}, {
   3.944216917674034*^9, 3.9442169211364985`*^9}, {3.944216980593791*^9, 
   3.9442170176852617`*^9}, {3.944217135022238*^9, 3.9442171742519917`*^9}, {
   3.944217240347865*^9, 3.9442172443135386`*^9}, {3.944217371166978*^9, 
   3.944217415877095*^9}, {3.944217458112097*^9, 3.944217489319969*^9}, {
   3.9442176743020687`*^9, 3.944217754022464*^9}, {3.9442177899157567`*^9, 
   3.944217948225746*^9}, 3.944218119610191*^9, {3.944218163988905*^9, 
   3.944218216364073*^9}, {3.9442228907182455`*^9, 3.9442228927985*^9}, {
   3.9442229579402514`*^9, 3.9442230294696813`*^9}, {3.9442230688368287`*^9, 
   3.944223467780363*^9}, {3.9442235035079527`*^9, 3.944223588425582*^9}, {
   3.944223632700884*^9, 3.9442236685902863`*^9}, {3.9442237051630707`*^9, 
   3.94422371055993*^9}, {3.9442237419273977`*^9, 3.944223743759412*^9}, {
   3.9442237793291063`*^9, 3.944223844414757*^9}, {3.9442238908221035`*^9, 
   3.9442238960397387`*^9}, {3.9442239378596425`*^9, 3.944223938078417*^9}, {
   3.9442240016824107`*^9, 3.9442240198116503`*^9}, {3.9442240523969517`*^9, 
   3.944224054005825*^9}, {3.9442240978714037`*^9, 3.9442240996602182`*^9}, {
   3.9442241308609962`*^9, 3.94422413288437*^9}, {3.944224208230159*^9, 
   3.94422425607296*^9}, {3.9442242952770157`*^9, 3.9442243230015893`*^9}, {
   3.9442243622817717`*^9, 3.9442243902139387`*^9}, {3.944224420287759*^9, 
   3.944224430226183*^9}, {3.9442244616190825`*^9, 3.9442244799770403`*^9}, {
   3.9442245194413404`*^9, 3.944224527085495*^9}, {3.9442245614282475`*^9, 
   3.944224651646366*^9}, {3.9442248749213753`*^9, 3.944224876398879*^9}, {
   3.944224917454773*^9, 3.9442249420580225`*^9}, {3.9442251137307243`*^9, 
   3.944225115347595*^9}, {3.9442251636380067`*^9, 3.94422516775977*^9}, {
   3.944225298374459*^9, 3.94422529867881*^9}, 3.9442256121155443`*^9, {
   3.9442283734114037`*^9, 3.9442284122681637`*^9}, {3.94422846355962*^9, 
   3.944228471108388*^9}, {3.9442285085777135`*^9, 3.94422852426255*^9}, {
   3.9442285665223937`*^9, 3.944228606180025*^9}, {3.944554728050563*^9, 
   3.9445547378360453`*^9}, {3.9445559357199955`*^9, 3.944555959331607*^9}, {
   3.9445560068997765`*^9, 3.9445560529456806`*^9}, {3.9445560986949863`*^9, 
   3.9445561509110107`*^9}, {3.944556269463277*^9, 3.944556295959454*^9}, {
   3.944556354114865*^9, 3.94455636508296*^9}, {3.9445564308025966`*^9, 
   3.944556461134863*^9}, {3.9445565492571588`*^9, 3.9445565496187267`*^9}, {
   3.944573012759553*^9, 3.9445730487654305`*^9}, {3.944573093156842*^9, 
   3.944573095202726*^9}, {3.944573269489832*^9, 3.944573312841898*^9}, {
   3.9470612367836585`*^9, 3.9470612371564136`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"07af5e8e-96a4-473a-b3d1-69c41bf3dae2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Generate", " ", "Figure"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"capacitance", "=", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Ct", "[", "t", "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "maxtime"}], "}"}], ",", 
       RowBox[{"PlotPoints", "->", "10000"}], ",", 
       RowBox[{"MaxRecursion", "->", "3"}], ",", 
       RowBox[{"PlotStyle", "->", "Orange"}], ",", " ", 
       RowBox[{"AspectRatio", "->", 
        RowBox[{"1", "/", "8"}]}], ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "maxtime"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1.5"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"20", ",", "20"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "5"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Frame", "->", "False"}], ",", 
       RowBox[{"Axes", "->", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<\>\"", ",", "\"\<Capacitance\>\""}], "}"}]}], ",", 
       RowBox[{"TicksStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"FontOpacity", "->", "0"}], ",", 
            RowBox[{"FontSize", "->", "0"}]}], "]"}], ",", "Automatic"}], 
         "}"}]}], ",", 
       RowBox[{"Ticks", "->", 
        RowBox[{"{", 
         RowBox[{"None", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0.5", ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tags", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"35", ",", "1.1"}], "}"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<a\>\"", ",", 
             RowBox[{"Darker", "[", "Green", "]"}], ",", 
             RowBox[{"FontSize", "->", "14"}]}], "]"}], ",", 
           RowBox[{"Background", "\[Rule]", "None"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"130", ",", "1.1"}], "}"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<b\>\"", ",", 
             RowBox[{"Darker", "[", "Green", "]"}], ",", 
             RowBox[{"FontSize", "->", "14"}]}], "]"}], ",", 
           RowBox[{"Background", "\[Rule]", "None"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"240", ",", "1.1"}], "}"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<c\>\"", ",", 
             RowBox[{"Darker", "[", "Green", "]"}], ",", 
             RowBox[{"FontSize", "->", "14"}]}], "]"}], ",", 
           RowBox[{"Background", "\[Rule]", "None"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"307", ",", "1.1"}], "}"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<d\>\"", ",", 
             RowBox[{"Darker", "[", "Green", "]"}], ",", 
             RowBox[{"FontSize", "->", "14"}]}], "]"}], ",", 
           RowBox[{"Background", "\[Rule]", "None"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"378", ",", "1.1"}], "}"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<e\>\"", ",", 
             RowBox[{"Darker", "[", "Green", "]"}], ",", 
             RowBox[{"FontSize", "->", "14"}]}], "]"}], ",", 
           RowBox[{"Background", "\[Rule]", "None"}]}], "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"490", ",", "1.1"}], "}"}], ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<f\>\"", ",", 
             RowBox[{"Darker", "[", "Green", "]"}], ",", 
             RowBox[{"FontSize", "->", "14"}]}], "]"}], ",", 
           RowBox[{"Background", "\[Rule]", "None"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"{", 
         RowBox[{"Opacity", "[", "0", "]"}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"voltage", "=", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"U1", "[", "t", "]"}], "/", 
        RowBox[{"Ct", "[", "t", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "maxtime"}], "}"}], ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "maxtime"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2.5"}], ",", "2.5"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotPoints", "->", "10000"}], ",", " ", 
       RowBox[{"AspectRatio", "->", 
        RowBox[{"1", "/", "8"}]}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"50", ",", "20"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Frame", "->", "False"}], ",", 
       RowBox[{"Axes", "->", 
        RowBox[{"{", 
         RowBox[{"False", ",", "False"}], "}"}]}], ",", 
       RowBox[{"FrameLabel", "->", 
        RowBox[{"{", 
         RowBox[{"None", ",", "\"\<Voltage\>\""}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"{", 
         RowBox[{"Opacity", "[", "0.6", "]"}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "->", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "0", ",", "2"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Epilog", "->", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{"\"\<Threshold\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"50", ",", "1.45"}], "}"}]}], "]"}], ",", 
          RowBox[{"FontSize", "->", "11"}]}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"thresholdLine", "=", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Dashed", ",", " ", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"maxtime", ",", "1"}], "}"}]}], "}"}], "]"}]}], "}"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"peaks", " ", "=", " ", 
     RowBox[{"FindPeaks", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"U1", "[", "t", "]"}], "/", 
          RowBox[{"Ct", "[", "t", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "1", ",", "maxtime", ",", "1"}], "}"}]}], "]"}], 
       ",", "2", ",", "0", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rasterLines", "=", 
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", 
          RowBox[{"Darker", "[", "Blue", "]"}], ",", " ", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xk", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"xk", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "}"}]}], "}"}], 
           "]"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"xk", ",", "peaks"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rasterCanvas", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Table", "[", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xk", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"xk", ",", "peaks"}], "}"}]}], "]"}], ",", " ", 
       RowBox[{"AspectRatio", "->", 
        RowBox[{"1", "/", "16"}]}], ",", 
       RowBox[{"ImageSize", "->", "Large"}], ",", 
       RowBox[{"Axes", "->", 
        RowBox[{"{", 
         RowBox[{"False", ",", "False"}], "}"}]}], ",", 
       RowBox[{"Frame", "->", "True"}], ",", 
       RowBox[{"FrameTicks", "->", "False"}], ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "maxtime"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1.4"}], ",", "1.4"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"50", ",", "20"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "0"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"PointSize", "[", "0", "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g1", "=", 
     RowBox[{"GraphicsGrid", "[", 
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Show", "[", 
          RowBox[{"capacitance", ",", "tags"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Show", "[", 
          RowBox[{"voltage", ",", "thresholdLine"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Show", "[", 
          RowBox[{"rasterCanvas", ",", "rasterLines"}], "]"}], "}"}]}], "}"}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bands", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{"Gray", ",", 
          RowBox[{"Opacity", "[", "0.15", "]"}], ",", 
          RowBox[{"Rectangle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"70", ",", 
              RowBox[{"-", "215"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"140", ",", "0"}], "}"}]}], "]"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{"Gray", ",", 
          RowBox[{"Opacity", "[", "0.15", "]"}], ",", 
          RowBox[{"Rectangle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"145", ",", 
              RowBox[{"-", "215"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"235", ",", "0"}], "}"}]}], "]"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{"Gray", ",", 
          RowBox[{"Opacity", "[", "0.15", "]"}], ",", 
          RowBox[{"Rectangle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"240", ",", 
              RowBox[{"-", "215"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"300", ",", "0"}], "}"}]}], "]"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{"Gray", ",", 
          RowBox[{"Opacity", "[", "0.15", "]"}], ",", 
          RowBox[{"Rectangle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"308", ",", 
              RowBox[{"-", "215"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"352", ",", "0"}], "}"}]}], "]"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{"Gray", ",", 
          RowBox[{"Opacity", "[", "0.15", "]"}], ",", 
          RowBox[{"Rectangle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"360", ",", 
              RowBox[{"-", "215"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"470", ",", "0"}], "}"}]}], "]"}]}], "}"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{"Gray", ",", 
          RowBox[{"Opacity", "[", "0.15", "]"}], ",", 
          RowBox[{"Rectangle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"475", ",", 
              RowBox[{"-", "215"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"550", ",", "0"}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tagsFinal", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"35", ",", 
             RowBox[{"-", "80"}]}], "}"}], ",", 
           RowBox[{"Style", "[", "\"\<C=0\>\"", "]"}], ",", 
           RowBox[{"Background", "->", "None"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"35", ",", 
             RowBox[{"-", "35"}]}], "}"}], ",", 
           RowBox[{
           "Style", "[", "\"\<C=\!\(\*SubscriptBox[\(C\), \(0\)]\)\>\"", 
            "]"}], ",", 
           RowBox[{"Background", "->", "None"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"35", ",", 
             RowBox[{"-", "140"}]}], "}"}], ",", 
           RowBox[{
           "Style", "[", "\"\<V=\!\(\*SubscriptBox[\(V\), \(0\)]\)\>\"", 
            "]"}], ",", 
           RowBox[{"Background", "->", "None"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"{", 
         RowBox[{"Opacity", "[", "0", "]"}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"labels", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"10", ",", 
             RowBox[{"-", "60"}]}], "}"}], ",", 
           RowBox[{"Rotate", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<\!\(\*SubscriptBox[\(C\), \(m\)]\)(t)\>\"", ",", 
               RowBox[{"FontSize", "\[Rule]", "12"}], ",", "Orange"}], "]"}], 
             ",", 
             RowBox[{"Pi", "/", "2"}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"10", ",", 
             RowBox[{"-", "145"}]}], "}"}], ",", 
           RowBox[{"Rotate", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<\!\(\*SubscriptBox[\(V\), \(m\)]\)(t)\>\"", ",", 
               RowBox[{"FontSize", "\[Rule]", "12"}], ",", "Blue"}], "]"}], 
             ",", 
             RowBox[{"Pi", "/", "2"}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"10", ",", 
             RowBox[{"-", "215"}]}], "}"}], ",", 
           RowBox[{"Rotate", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<Raster\>\"", ",", 
               RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
               RowBox[{"Darker", "[", "Blue", "]"}]}], "]"}], ",", 
             RowBox[{"Pi", "/", "2"}]}], "]"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"{", 
         RowBox[{"Opacity", "[", "0", "]"}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"g2", "=", 
    RowBox[{"Show", "[", 
     RowBox[{"bands", ",", "g1", ",", "tagsFinal", ",", "labels", ",", 
      RowBox[{"ImageSize", "->", "Large"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<Fig1.eps\>\"", ",", "g2"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9445733190982075`*^9, 3.944573360873895*^9}, {
  3.9445734133046856`*^9, 3.9445735392078514`*^9}, {3.9445744778522983`*^9, 
  3.9445744801540704`*^9}, {3.9445745156474447`*^9, 3.944574553461808*^9}, {
  3.9445748757135897`*^9, 3.9445748806388693`*^9}, {3.944574938910866*^9, 
  3.9445749691429586`*^9}, {3.9445750000637145`*^9, 3.944575006013131*^9}, {
  3.9445751031476903`*^9, 3.9445751221689644`*^9}, {3.944575223956758*^9, 
  3.9445752248833284`*^9}, {3.945767593367612*^9, 3.9457676073145313`*^9}, {
  3.945767785999031*^9, 3.945767815708981*^9}, {3.9470607019907722`*^9, 
  3.9470607027554765`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"95e3ba23-64f8-46ab-8be6-98cb6fe229ee"]
},
WindowSize->{1141.2, 568.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
DockedCells->{},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>1.1 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2afc118e-1ede-4010-831b-6894c0568252"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 14253, 302, 1012, "Input",ExpressionUUID->"6add7b26-39a8-4826-b72b-5aaa68dd0471",
 InitializationCell->True],
Cell[14814, 324, 10740, 172, 73, "Input",ExpressionUUID->"07af5e8e-96a4-473a-b3d1-69c41bf3dae2"],
Cell[25557, 498, 17397, 457, 952, "Input",ExpressionUUID->"95e3ba23-64f8-46ab-8be6-98cb6fe229ee"]
}
]
*)

