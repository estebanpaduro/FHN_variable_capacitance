(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     48897,       1011]
NotebookOptionsPosition[     48238,        992]
NotebookOutlinePosition[     48719,       1010]
CellTagsIndexPosition[     48676,       1007]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "notebook", " ", "is", " ", "used", " ", "to", " ", 
     "generate", " ", "figure", " ", "8", " ", 
     RowBox[{"(", "a", ")"}]}], ",", " ", 
    RowBox[{"(", "f", ")"}], ",", " ", 
    RowBox[{"and", " ", 
     RowBox[{"(", "k", ")"}], " ", "in", " ", "the", " ", "article", 
     "\[IndentingNewLine]", 
     "\"\<Analysis of Neural Activation in Time-dependent Membrane \
Capacitance Models\>\"", " ", "by", " ", "\[IndentingNewLine]", "Courdurier", 
     " ", 
     RowBox[{"M", "."}]}], " ", ",", " ", 
    RowBox[{"Medina", " ", 
     RowBox[{"L", ".", " ", "E", ".", " ", "and"}], " ", "Paduro", " ", 
     RowBox[{"E", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"threshold", "=", "0"}], ";", 
    RowBox[{"maxtime", "=", "1000"}], ";", 
    RowBox[{"\[Kappa]2", "=", "0.5"}], ";", 
    RowBox[{"\[Kappa]4", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"case", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Switch", "[", 
    RowBox[{"case", ",", "\[IndentingNewLine]", "1", ",", 
     RowBox[{
      RowBox[{"C0", "=", "1"}], ";", 
      RowBox[{"T", "=", "50"}], ";", 
      RowBox[{"filename", "=", "\"\<Fig8a.eps\>\""}], ";"}], ",", 
     "\[IndentingNewLine]", "2", ",", 
     RowBox[{
      RowBox[{"C0", "=", "1"}], ";", 
      RowBox[{"T", "=", "20"}], ";", 
      RowBox[{"filename", "=", "\"\<Fig8f.eps\>\""}], ";"}], ",", 
     "\[IndentingNewLine]", "3", ",", 
     RowBox[{
      RowBox[{"C0", "=", "1"}], ";", 
      RowBox[{"T", "=", "0.5"}], ";", 
      RowBox[{"filename", "=", "\"\<Fig8k.eps\>\""}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Parameters", " ", "taken", " ", "from", " ", 
      RowBox[{
      "\"\<A. L. Hodgkin and A. F. Huxley. A quantitative description of \
membrane current and its application to\nconduction and excitability in nerve\
\>\"", ".", " ", "J", ".", " ", "Physiol", ".", " ", 
       RowBox[{"(", "London", ")"}]}]}], ",", " ", 
     RowBox[{"117", ":", "500"}], "\[Dash]", "544", ",", " ", "1952"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]m", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Beta]m", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]h", "=", "0.07"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Beta]h", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]n", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Beta]n", "=", "0.125"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ENa", "=", "115"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EK", "=", 
     RowBox[{"-", "12"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EL", "=", "10.613"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vrest", "=", 
     RowBox[{"-", "65"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mrest", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hrest", "=", "0.596"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nrest", "=", "0.315"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V\[Alpha]m", "=", "25"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V\[Beta]m", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V\[Alpha]h", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V\[Beta]h", "=", "30"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V\[Alpha]n", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V\[Beta]n", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gNa", "=", "120"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gK", "=", "36"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gL", "=", "0.3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"K\[Alpha]m", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"K\[Beta]m", "=", "18"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"K\[Alpha]h", "=", "20"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"K\[Beta]h", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"K\[Alpha]n", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"K\[Beta]n", "=", "80"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Cm", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Ionic", " ", "Chanels"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Am", "[", "V_", "]"}], "=", 
     RowBox[{"\[Alpha]m", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"V", "-", "V\[Alpha]m"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"V", "-", "V\[Alpha]m"}], ")"}]}], "/", "K\[Alpha]m"}], 
          "]"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Bm", "[", "V_", "]"}], "=", 
     RowBox[{"\[Beta]m", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"V", "-", "V\[Beta]m"}], ")"}]}], "/", "K\[Beta]m"}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Ah", "[", "V_", "]"}], "=", 
     RowBox[{"\[Alpha]h", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"V", "-", "V\[Alpha]h"}], ")"}]}], "/", "K\[Alpha]h"}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Bh", "[", "V_", "]"}], "=", 
     RowBox[{"\[Beta]h", "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"V", "-", "V\[Beta]h"}], ")"}]}], "/", "K\[Beta]h"}], 
         "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"An", "[", "V_", "]"}], "=", 
     RowBox[{"\[Alpha]n", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"V", "-", "V\[Alpha]n"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"V", "-", "V\[Alpha]n"}], ")"}]}], "/", "K\[Alpha]n"}], 
          "]"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Bn", "[", "V_", "]"}], "=", 
     RowBox[{"\[Beta]n", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"V", "-", "V\[Beta]n"}], ")"}]}], "/", "K\[Beta]n"}], 
       "]"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.933417619341799*^9, 3.933417631000944*^9}, {
   3.933420270403441*^9, 3.9334202706383314`*^9}, {3.9336768498759046`*^9, 
   3.9336768628546886`*^9}, {3.933678985666159*^9, 3.9336789947248197`*^9}, {
   3.9419003371943903`*^9, 3.9419003578964357`*^9}, {3.941900408951553*^9, 
   3.9419004548551297`*^9}, {3.941900521489539*^9, 3.9419005227635913`*^9}, 
   3.941900597639367*^9, {3.9419012080683203`*^9, 3.9419012082337933`*^9}, {
   3.941902491858902*^9, 3.941902512476169*^9}, {3.9419027383420095`*^9, 
   3.941902738415152*^9}, {3.9419029041639986`*^9, 3.941902953210053*^9}, {
   3.9419036002029686`*^9, 3.9419036345581503`*^9}, {3.941904308717148*^9, 
   3.9419043087882957`*^9}, {3.9428462486740503`*^9, 3.942846286115071*^9}, 
   3.9428471978067403`*^9, {3.9428472339157953`*^9, 3.942847260615965*^9}, {
   3.9428492576229944`*^9, 3.942849291053322*^9}, {3.9428493256191607`*^9, 
   3.942849330479043*^9}, {3.942849945108218*^9, 3.9428499633346214`*^9}, {
   3.942852244236715*^9, 3.9428522443156977`*^9}, 3.942852810825324*^9, {
   3.9428590829978724`*^9, 3.942859090222334*^9}, 3.9428593107046747`*^9, {
   3.942860712819275*^9, 3.942860713439972*^9}, {3.942866296580149*^9, 
   3.942866300387828*^9}, {3.943352874527054*^9, 3.94335289536453*^9}, 
   3.9433534887600074`*^9, 3.943353664033471*^9, 3.943354290274747*^9, {
   3.943355964863742*^9, 3.9433559652798147`*^9}, {3.9458761471075425`*^9, 
   3.945876158731024*^9}, 3.9458778445748944`*^9, 3.9458781156962337`*^9, 
   3.945892475617676*^9, 3.946471660478441*^9, {3.946471697342026*^9, 
   3.946471697514818*^9}, {3.946971976620902*^9, 3.9469720260470123`*^9}, {
   3.9469722414910083`*^9, 3.946972260553609*^9}, 3.9469725242578917`*^9, 
   3.9469729049756184`*^9, {3.947074996224369*^9, 3.9470750047780356`*^9}, {
   3.9470750914230747`*^9, 3.947075122654889*^9}, 3.947075186531175*^9, 
   3.9470756016970105`*^9, 3.9470762567628965`*^9, 3.947083615979478*^9},
 CellLabel->"In[80]:=",ExpressionUUID->"53e0b4d8-0a42-487d-a349-c6b3239d0626"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Solving", " ", "HH"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fRateHH", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fRateHHs", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"simulation", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Kappa]1", "=", 
          RowBox[{"0.1", "+", "\[Delta]"}]}], ";", 
         RowBox[{"\[Kappa]3", "=", 
          RowBox[{"0.6", "+", "\[Delta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Define", " ", "capacitance", " ", "function"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Ct", "[", "t_", "]"}], "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"t", ",", "T"}], "]"}], "<", 
             RowBox[{"\[Kappa]1", " ", "T"}]}], ",", "C0", ",", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"t", ",", "T"}], "]"}], "<", 
             RowBox[{"\[Kappa]2", " ", "T"}]}], ",", 
            RowBox[{"C0", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"C1", "-", "C0"}], ")"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{"t", ",", "T"}], "]"}], "-", 
                 RowBox[{"\[Kappa]1", " ", "T"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Kappa]2", "-", "\[Kappa]1"}], ")"}], "T"}], 
                ")"}]}]}]}], ",", " ", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"t", ",", "T"}], "]"}], "<", 
             RowBox[{"\[Kappa]3", " ", "T"}]}], ",", "C1", ",", " ", "True", 
            ",", 
            RowBox[{"C1", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{"t", ",", "T"}], "]"}], " ", "-", " ", 
                RowBox[{"\[Kappa]3", " ", "T"}]}], ")"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"C0", "-", "C1"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Kappa]4", "-", "\[Kappa]3"}], ")"}], "T"}], 
                ")"}]}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Ctd", "[", "t_", "]"}], "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"t", ",", "T"}], "]"}], "<", 
             RowBox[{"\[Kappa]1", " ", "T"}]}], ",", "0", ",", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"t", ",", "T"}], "]"}], "<", 
             RowBox[{"\[Kappa]2", " ", "T"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"C1", "-", "C0"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Kappa]2", "-", "\[Kappa]1"}], ")"}], "T"}], 
              ")"}]}], ",", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"t", ",", "T"}], "]"}], "<", " ", 
             RowBox[{"\[Kappa]3", " ", "T"}]}], ",", "0", ",", " ", "True", 
            ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"C0", "-", "C1"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Kappa]4", "-", "\[Kappa]3"}], ")"}], "T"}], 
              ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Solving", " ", "HH"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"U", ",", "M", ",", "H", ",", "NN"}], "}"}], "=", 
          RowBox[{"NDSolveValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"u", "'"}], "[", "t", "]"}], "\[Equal]", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "gNa"}], " ", 
                 RowBox[{
                  RowBox[{"m", "[", "t", "]"}], "^", "3"}], " ", 
                 RowBox[{"h", "[", "t", "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"u", "[", "t", "]"}], "/", 
                    RowBox[{"Ct", "[", "t", "]"}]}], "-", "Vrest", "-", 
                   "ENa"}], ")"}]}], "-", 
                RowBox[{"gK", " ", 
                 RowBox[{
                  RowBox[{"n", "[", "t", "]"}], "^", "4"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"u", "[", "t", "]"}], "/", 
                    RowBox[{"Ct", "[", "t", "]"}]}], "-", "Vrest", "-", 
                   "EK"}], ")"}]}], " ", "-", 
                RowBox[{"gL", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"u", "[", "t", "]"}], "/", 
                    RowBox[{"Ct", "[", "t", "]"}]}], "-", "Vrest", "-", 
                   "EL"}], ")"}]}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"m", "'"}], "[", "t", "]"}], "\[Equal]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Am", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"u", "[", "t", "]"}], "/", 
                    RowBox[{"Ct", "[", "t", "]"}]}], "-", "Vrest"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"m", "[", "t", "]"}]}], ")"}]}], "-", 
                RowBox[{
                 RowBox[{"Bm", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"u", "[", "t", "]"}], "/", 
                    RowBox[{"Ct", "[", "t", "]"}]}], "-", "Vrest"}], "]"}], 
                 RowBox[{"m", "[", "t", "]"}]}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"h", "'"}], "[", "t", "]"}], "\[Equal]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Ah", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"u", "[", "t", "]"}], "/", 
                    RowBox[{"Ct", "[", "t", "]"}]}], "-", "Vrest"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"h", "[", "t", "]"}]}], ")"}]}], "-", 
                RowBox[{
                 RowBox[{"Bh", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"u", "[", "t", "]"}], "/", 
                    RowBox[{"Ct", "[", "t", "]"}]}], "-", "Vrest"}], "]"}], 
                 " ", 
                 RowBox[{"h", "[", "t", "]"}]}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"n", "'"}], "[", "t", "]"}], "\[Equal]", 
               RowBox[{
                RowBox[{
                 RowBox[{"An", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"u", "[", "t", "]"}], "/", 
                    RowBox[{"Ct", "[", "t", "]"}]}], "-", "Vrest"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"n", "[", "t", "]"}]}], ")"}]}], "-", 
                RowBox[{
                 RowBox[{"Bn", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"u", "[", "t", "]"}], "/", 
                    RowBox[{"Ct", "[", "t", "]"}]}], "-", "Vrest"}], "]"}], 
                 RowBox[{"n", "[", "t", "]"}]}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"u", "[", "0", "]"}], "\[Equal]", 
               RowBox[{
                RowBox[{"Ct", "[", "0", "]"}], "*", "Vrest"}]}], ",", 
              RowBox[{
               RowBox[{"m", "[", "0", "]"}], "\[Equal]", "mrest"}], ",", 
              RowBox[{
               RowBox[{"h", "[", "0", "]"}], "\[Equal]", "hrest"}], ",", 
              RowBox[{
               RowBox[{"n", "[", "0", "]"}], "\[Equal]", "nrest"}]}], "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"u", ",", "m", ",", "h", ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "maxtime"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"peaksHH", " ", "=", " ", 
          RowBox[{"FindPeaks", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"U", "[", "t", "]"}], "/", 
               RowBox[{"Ct", "[", "t", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "0", ",", "maxtime", ",", "1"}], "}"}]}], 
             "]"}], ",", "2", ",", "0", ",", "threshold"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"countHH", "=", 
          RowBox[{"Length", "[", "peaksHH", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"pointHH", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"\[Delta]", ",", 
            RowBox[{"C0", "-", "C1"}], ",", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"countHH", "/", "maxtime"}], " ", "*", "1000"}], 
             "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"fRateHH", " ", "=", " ", 
          RowBox[{"Append", "[", 
           RowBox[{"fRateHH", ",", "pointHH"}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"\[Delta]", ",", "0", ",", "0.399", ",", "0.04"}], "}"}]}], 
       "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"C1", ",", "0.4", ",", "1", ",", "0.05"}], "}"}]}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8365764195893507`*^9, 3.8365764829171247`*^9}, {
   3.836576563195706*^9, 3.83657656781206*^9}, {3.836576613744201*^9, 
   3.8365766304744773`*^9}, {3.836576673277386*^9, 3.8365766762242303`*^9}, {
   3.836576756596757*^9, 3.8365768620848365`*^9}, {3.8365769238733177`*^9, 
   3.836577092849555*^9}, {3.836577134450241*^9, 3.8365771807249537`*^9}, {
   3.8365772331972375`*^9, 3.8365772622701263`*^9}, {3.8365773053024683`*^9, 
   3.8365773118437157`*^9}, {3.8365779758994503`*^9, 3.836578267409032*^9}, {
   3.8365799276423674`*^9, 3.8365799589959183`*^9}, {3.8365801829034986`*^9, 
   3.8365803231632805`*^9}, {3.83658036364727*^9, 3.836580365789157*^9}, {
   3.836580435003389*^9, 3.8365805925812736`*^9}, {3.836580631234239*^9, 
   3.836580727700471*^9}, {3.8365807679908*^9, 3.836580804094198*^9}, {
   3.8365808533515635`*^9, 3.836580954574869*^9}, {3.836580987961808*^9, 
   3.8365810017316155`*^9}, {3.8365813186628532`*^9, 
   3.8365814528246155`*^9}, {3.8365814847677407`*^9, 
   3.8365814946075363`*^9}, {3.836581664416989*^9, 3.8365816686415854`*^9}, {
   3.8365817091627893`*^9, 3.836581794425687*^9}, {3.836581827983651*^9, 
   3.8365818675145864`*^9}, {3.836581924077717*^9, 3.8365819242084675`*^9}, {
   3.836581954787426*^9, 3.8365821415199475`*^9}, {3.8365832033485312`*^9, 
   3.836583215570546*^9}, {3.836583262961662*^9, 3.836583324434626*^9}, {
   3.8365833783917933`*^9, 3.8365834439630885`*^9}, {3.836583476393632*^9, 
   3.836583601730036*^9}, {3.8365836490918875`*^9, 3.8365836492586555`*^9}, {
   3.8365838096790094`*^9, 3.836584040103962*^9}, {3.836584108502695*^9, 
   3.836584125222884*^9}, {3.836584197058638*^9, 3.8365842237479577`*^9}, {
   3.836584254396799*^9, 3.836584634019613*^9}, {3.83658468412457*^9, 
   3.8365847126167297`*^9}, {3.83658477666457*^9, 3.8365847964099884`*^9}, {
   3.8365857669190836`*^9, 3.8365858224996667`*^9}, {3.836586167908511*^9, 
   3.8365861688613625`*^9}, {3.836586220960807*^9, 3.8365862475982227`*^9}, {
   3.8365905327558355`*^9, 3.8365905550983243`*^9}, {3.8365906499048123`*^9, 
   3.8365906561725283`*^9}, {3.836590716641168*^9, 3.8365907651284957`*^9}, {
   3.836590806435878*^9, 3.836590811631076*^9}, {3.8365908443436766`*^9, 
   3.8365911279233017`*^9}, {3.8365911991492863`*^9, 3.836591204615698*^9}, {
   3.8365912610885863`*^9, 3.8365912822445087`*^9}, {3.8365913174250154`*^9, 
   3.836591352109292*^9}, {3.8365914495056806`*^9, 3.836591498030156*^9}, {
   3.8365915371297426`*^9, 3.8365915554655848`*^9}, {3.8365916699752483`*^9, 
   3.8365917661641226`*^9}, {3.8365919476083837`*^9, 
   3.8365920006576614`*^9}, {3.836592218483713*^9, 3.8365922541401367`*^9}, {
   3.836592638922042*^9, 3.836592639057246*^9}, {3.836592703174262*^9, 
   3.8365928285061493`*^9}, {3.836592860794361*^9, 3.8365928757700443`*^9}, {
   3.836592943432811*^9, 3.8365930241894464`*^9}, {3.836593057141816*^9, 
   3.83659306370382*^9}, {3.8365931007891293`*^9, 3.836593133677662*^9}, {
   3.8366523162536545`*^9, 3.8366523249447737`*^9}, {3.836654217715496*^9, 
   3.836654246837434*^9}, {3.837792234654108*^9, 3.8377922356688366`*^9}, {
   3.8377923063599358`*^9, 3.8377923227767906`*^9}, {3.8377923677255244`*^9, 
   3.83779238795697*^9}, {3.837792510609088*^9, 3.8377925246316833`*^9}, {
   3.8377926149525433`*^9, 3.837792644798376*^9}, {3.837792686529766*^9, 
   3.837792718350808*^9}, {3.8383170310739374`*^9, 3.838317156486467*^9}, {
   3.8383172150382476`*^9, 3.838317222799698*^9}, {3.838317295737906*^9, 
   3.838317344683237*^9}, {3.838318125827586*^9, 3.838318149766327*^9}, {
   3.8383182110878267`*^9, 3.8383183371365013`*^9}, {3.8383184996027007`*^9, 
   3.8383185956630096`*^9}, {3.8383186609859643`*^9, 3.838318743585454*^9}, {
   3.8383188023389616`*^9, 3.8383188051777143`*^9}, {3.83831896962801*^9, 
   3.838319103459008*^9}, {3.8383193291651354`*^9, 3.838319457446283*^9}, {
   3.838319487523017*^9, 3.838319663140216*^9}, {3.838319703469783*^9, 
   3.838319744559948*^9}, {3.838319789731165*^9, 3.83831984749162*^9}, {
   3.838319883188862*^9, 3.8383199338232584`*^9}, {3.838319987247695*^9, 
   3.838320088253944*^9}, 3.8383201314754777`*^9, {3.8383202161191854`*^9, 
   3.8383202162991753`*^9}, {3.8383202535864005`*^9, 3.838320256345936*^9}, {
   3.838320311476929*^9, 3.8383203336492577`*^9}, {3.8383204915102453`*^9, 
   3.8383205065566854`*^9}, {3.8383206228637815`*^9, 
   3.8383206373642673`*^9}, {3.838320693453684*^9, 3.8383206943477507`*^9}, {
   3.838320749981058*^9, 3.838320750242422*^9}, {3.8383207892443123`*^9, 
   3.838320794570098*^9}, {3.838320866876878*^9, 3.8383208682025704`*^9}, {
   3.8383209202616634`*^9, 3.8383209997649665`*^9}, {3.838321084820953*^9, 
   3.838321099207616*^9}, {3.8383212625273113`*^9, 3.838321265307842*^9}, {
   3.838321330015326*^9, 3.8383213303345623`*^9}, {3.8383214605330067`*^9, 
   3.8383214609381905`*^9}, 3.8383244409185553`*^9, {3.838324472711772*^9, 
   3.838324485491127*^9}, {3.838324516247577*^9, 3.8383245172200975`*^9}, {
   3.8383245920889797`*^9, 3.8383247498815985`*^9}, {3.8383248009786463`*^9, 
   3.8383248845776796`*^9}, {3.838325026246642*^9, 3.8383250675076747`*^9}, {
   3.8383251052721987`*^9, 3.8383252193378477`*^9}, {3.8383252553269405`*^9, 
   3.8383253274524956`*^9}, {3.838325535799447*^9, 3.8383256338472033`*^9}, {
   3.838326278703616*^9, 3.838326292285536*^9}, {3.838326386703421*^9, 
   3.8383264532461452`*^9}, {3.8383264949498377`*^9, 3.838326520341936*^9}, {
   3.8383265516102095`*^9, 3.8383267154425054`*^9}, {3.838326776889882*^9, 
   3.838326818281168*^9}, {3.838326920496654*^9, 3.83832705120203*^9}, {
   3.8383271021141014`*^9, 3.8383271229451456`*^9}, {3.838327157039203*^9, 
   3.8383273680647993`*^9}, {3.8383275095340776`*^9, 3.838327552795931*^9}, {
   3.8383276660629625`*^9, 3.8383276830808697`*^9}, {3.838327753254162*^9, 
   3.8383277772964344`*^9}, {3.838327829853933*^9, 3.838327831072505*^9}, {
   3.8383279009319196`*^9, 3.8383279097219224`*^9}, {3.838327959348919*^9, 
   3.838327990863659*^9}, 3.838328031385612*^9, {3.8383281254519963`*^9, 
   3.8383281273203015`*^9}, {3.8383286584269123`*^9, 3.838328660844077*^9}, {
   3.838328779991006*^9, 3.838328795762386*^9}, {3.838328877775049*^9, 
   3.8383288962927237`*^9}, {3.838328940260338*^9, 3.8383289658395567`*^9}, {
   3.838329007758774*^9, 3.8383290480981674`*^9}, {3.8383291655431633`*^9, 
   3.838329165680171*^9}, 3.8383293160468884`*^9, {3.838329369746064*^9, 
   3.838329405067331*^9}, {3.8383297863425083`*^9, 3.8383298183825083`*^9}, {
   3.838329933579591*^9, 3.838329994830738*^9}, {3.838330030892997*^9, 
   3.838330088487258*^9}, {3.8383301715509467`*^9, 3.838330195393133*^9}, {
   3.8383747703211*^9, 3.8383748861486177`*^9}, {3.8383749209200287`*^9, 
   3.838374921341647*^9}, {3.838375053457736*^9, 3.838375066459689*^9}, {
   3.838375237020727*^9, 3.838375308368188*^9}, {3.83837534408945*^9, 
   3.8383753837590303`*^9}, {3.8383754157240596`*^9, 
   3.8383754580080843`*^9}, {3.838375515314296*^9, 3.838375516618822*^9}, 
   3.838375565332017*^9, {3.8383756283896704`*^9, 3.838375662362852*^9}, {
   3.8383757215713015`*^9, 3.838375727803584*^9}, 3.838375830719242*^9, {
   3.838376021055334*^9, 3.8383760737141905`*^9}, {3.838377636010127*^9, 
   3.838377638854209*^9}, {3.8383776720656786`*^9, 3.83837767500467*^9}, {
   3.838377936933522*^9, 3.8383780588880033`*^9}, {3.838378465601226*^9, 
   3.838378530893783*^9}, {3.8383785613040285`*^9, 3.838378579505561*^9}, {
   3.838378899760786*^9, 3.8383789914382453`*^9}, {3.8383793284622517`*^9, 
   3.8383793477775307`*^9}, 3.8383793880458727`*^9, {3.8383794246273937`*^9, 
   3.8383794335374594`*^9}, {3.838380090687162*^9, 3.838380111373036*^9}, {
   3.8383803857540164`*^9, 3.838380391989269*^9}, {3.838380492893998*^9, 
   3.8383805037042413`*^9}, {3.8383806497007074`*^9, 3.838380671636919*^9}, 
   3.838381049201826*^9, {3.8383811314135733`*^9, 3.8383811316615973`*^9}, {
   3.838381488953205*^9, 3.8383815289764843`*^9}, {3.838381776050458*^9, 
   3.8383819292312407`*^9}, {3.8383820171495914`*^9, 
   3.8383820275392256`*^9}, {3.838382143530456*^9, 3.8383821524497786`*^9}, {
   3.8383823065171056`*^9, 3.838382414598422*^9}, {3.838382448454052*^9, 
   3.8383826210558577`*^9}, {3.8383827268063755`*^9, 
   3.8383827287229967`*^9}, {3.838382985386251*^9, 3.8383830018382735`*^9}, {
   3.838383300747509*^9, 3.8383833151779175`*^9}, {3.83838350302902*^9, 
   3.838383550774655*^9}, {3.838383722281903*^9, 3.8383838318935843`*^9}, {
   3.8383840746108694`*^9, 3.8383840964895644`*^9}, {3.8383847196632557`*^9, 
   3.8383847221700935`*^9}, {3.8383847593335657`*^9, 
   3.8383847599737105`*^9}, {3.838385626198904*^9, 3.8383857182306905`*^9}, {
   3.8383859098984776`*^9, 3.838385925507492*^9}, {3.838386012769558*^9, 
   3.838386012833816*^9}, {3.838386054708759*^9, 3.838386104717902*^9}, {
   3.838386182156394*^9, 3.838386182563951*^9}, {3.838386239062388*^9, 
   3.838386254261436*^9}, {3.838386286561659*^9, 3.838386290663932*^9}, {
   3.838386340913731*^9, 3.8383864052532167`*^9}, {3.838386487499736*^9, 
   3.838386509061555*^9}, {3.8383865408625555`*^9, 3.8383865430521393`*^9}, {
   3.838389261650277*^9, 3.8383892922456408`*^9}, {3.8383893865003433`*^9, 
   3.8383895701484003`*^9}, {3.838389756605405*^9, 3.8383898391097755`*^9}, {
   3.8383898701921277`*^9, 3.838389870419179*^9}, 3.8383899105668807`*^9, {
   3.8383899437444353`*^9, 3.8383899946621647`*^9}, 3.8383900305228043`*^9, {
   3.8383901107727485`*^9, 3.838390216469243*^9}, {3.8383905245206127`*^9, 
   3.8383905255095754`*^9}, {3.8383907238567967`*^9, 
   3.8383907239590454`*^9}, {3.8383907629472523`*^9, 
   3.8383907766377897`*^9}, {3.8383908302239623`*^9, 3.8383908474821897`*^9}, 
   3.838390958301692*^9, {3.8383910045777187`*^9, 3.8383910402866845`*^9}, 
   3.838391111123123*^9, 3.8383911923299723`*^9, 3.8383912381396275`*^9, 
   3.8383912758644133`*^9, 3.8383913507179766`*^9, {3.8383914131184797`*^9, 
   3.8383914135187645`*^9}, {3.8383915403755608`*^9, 3.838391543843011*^9}, 
   3.8383916335591183`*^9, {3.838391756464996*^9, 3.838391823582455*^9}, {
   3.8383919779209146`*^9, 3.8383920299213977`*^9}, {3.8383920662368927`*^9, 
   3.838392161931737*^9}, {3.8383921926554623`*^9, 3.8383922515261555`*^9}, {
   3.8383926237027493`*^9, 3.838392787868576*^9}, {3.8383933278749084`*^9, 
   3.8383935691460447`*^9}, {3.8383939219598417`*^9, 3.838393983604003*^9}, {
   3.8383940504006042`*^9, 3.838394282044882*^9}, {3.838394365991351*^9, 
   3.8383944719564543`*^9}, {3.8383945475249043`*^9, 3.838394548429838*^9}, {
   3.8383945843893557`*^9, 3.8383945892959237`*^9}, {3.8383946422383757`*^9, 
   3.838394721386423*^9}, 3.8383948527960453`*^9, {3.8383949138866587`*^9, 
   3.8383949164447975`*^9}, {3.8383951111755257`*^9, 3.838395152950941*^9}, {
   3.8383983836259556`*^9, 3.838398516320286*^9}, 3.838398654232634*^9, {
   3.8383987365963936`*^9, 3.8383987426631947`*^9}, {3.838398810601616*^9, 
   3.8383988145345016`*^9}, {3.838398898107514*^9, 3.838398898700506*^9}, {
   3.844855733210538*^9, 3.844855990104609*^9}, {3.8448560265803747`*^9, 
   3.844856041763418*^9}, {3.844856082510413*^9, 3.844856257014082*^9}, {
   3.844856308476571*^9, 3.844856380688995*^9}, {3.844856438548498*^9, 
   3.8448564794460573`*^9}, {3.844856515790332*^9, 3.844856655689087*^9}, {
   3.844856716441868*^9, 3.844856898021743*^9}, {3.8448570542102222`*^9, 
   3.844857086627*^9}, {3.84485713797717*^9, 3.844857207947405*^9}, {
   3.8448572801196003`*^9, 3.8448573627707787`*^9}, {3.8448573982805147`*^9, 
   3.8448575051360397`*^9}, {3.844857546602414*^9, 3.844857645556881*^9}, {
   3.844857895971208*^9, 3.844857970777006*^9}, {3.8448580238605137`*^9, 
   3.844858045123872*^9}, {3.844858102743593*^9, 3.844858162321286*^9}, {
   3.844858264888598*^9, 3.844858268351224*^9}, {3.844858309232163*^9, 
   3.844858368253297*^9}, {3.844858408589382*^9, 3.844858409771953*^9}, {
   3.844858447882628*^9, 3.8448585025052958`*^9}, {3.844859164428423*^9, 
   3.844859180719261*^9}, 3.8448592295059*^9, {3.8448592824127417`*^9, 
   3.8448592826261063`*^9}, {3.8448643893635902`*^9, 3.844864430999928*^9}, 
   3.8448645232798357`*^9, {3.844864615846882*^9, 3.844864649554582*^9}, {
   3.844864685863929*^9, 3.844864688403799*^9}, {3.844864751639145*^9, 
   3.8448647529305973`*^9}, {3.844864911629723*^9, 3.8448649117213707`*^9}, {
   3.8448649663037615`*^9, 3.8448650080749454`*^9}, {3.844865086164844*^9, 
   3.844865106925891*^9}, {3.844865167573247*^9, 3.844865206568925*^9}, {
   3.844865244026849*^9, 3.844865246528043*^9}, {3.8448653903796706`*^9, 
   3.8448653918806615`*^9}, {3.8448654282694006`*^9, 
   3.8448654438180337`*^9}, {3.844865503042523*^9, 3.8448655407245054`*^9}, {
   3.844865601444606*^9, 3.8448656479709272`*^9}, {3.8448656789982986`*^9, 
   3.8448657361617937`*^9}, {3.844865790227427*^9, 3.844865790942258*^9}, {
   3.844865867888235*^9, 3.844865920371602*^9}, {3.8448659685029774`*^9, 
   3.8448659686139016`*^9}, {3.8448660424019885`*^9, 3.844866062019904*^9}, {
   3.8448660921840477`*^9, 3.8448661560150414`*^9}, 3.844866191742773*^9, {
   3.8448662665803366`*^9, 3.8448662704200673`*^9}, {3.84486631269524*^9, 
   3.8448664069691553`*^9}, {3.8448664508931875`*^9, 
   3.8448664520810204`*^9}, {3.8448665957902956`*^9, 3.844866597136018*^9}, {
   3.844866628209899*^9, 3.844866719069068*^9}, {3.844866789389062*^9, 
   3.8448668227280164`*^9}, {3.844866864454033*^9, 3.8448668669014997`*^9}, {
   3.8448668969995227`*^9, 3.8448670684330997`*^9}, {3.844867107441722*^9, 
   3.84486712620269*^9}, {3.8448674120009975`*^9, 3.844867418394413*^9}, {
   3.8448675004909763`*^9, 3.84486750545739*^9}, {3.844867541589669*^9, 
   3.8448675459560633`*^9}, {3.8448675853037987`*^9, 
   3.8448676401688037`*^9}, {3.8448677982012625`*^9, 
   3.8448678524347534`*^9}, {3.844867890233364*^9, 3.8448679142801704`*^9}, {
   3.8448679690161657`*^9, 3.8448680105101347`*^9}, {3.844868128160612*^9, 
   3.8448681391698985`*^9}, {3.8448682304868965`*^9, 
   3.8448683242353983`*^9}, {3.844868369283841*^9, 3.8448683918000097`*^9}, {
   3.8448724980971684`*^9, 3.844872532650019*^9}, {3.844872566597084*^9, 
   3.8448725677492647`*^9}, {3.844872781828865*^9, 3.8448728273379793`*^9}, {
   3.8448729079691734`*^9, 3.844872909610772*^9}, {3.844873226779456*^9, 
   3.84487322864491*^9}, {3.8448732822435284`*^9, 3.844873289023261*^9}, {
   3.84487384426333*^9, 3.8448738460229564`*^9}, {3.8655918546129847`*^9, 
   3.865592008602827*^9}, {3.8655920731217747`*^9, 3.86559227893406*^9}, {
   3.865592363377082*^9, 3.8655923957875223`*^9}, {3.8655928811202497`*^9, 
   3.8655928845640974`*^9}, 3.8655930138579893`*^9, {3.865593122268548*^9, 
   3.865593125990983*^9}, {3.8655931638511963`*^9, 3.8655931641747255`*^9}, {
   3.8655954354293876`*^9, 3.865595435902403*^9}, {3.8655955555487432`*^9, 
   3.8655955561108913`*^9}, {3.865602110663563*^9, 3.8656021142605658`*^9}, {
   3.865602148812741*^9, 3.8656021568982563`*^9}, {3.865602219200683*^9, 
   3.8656022259009*^9}, {3.86560233962505*^9, 3.8656023533945875`*^9}, {
   3.8656023848221283`*^9, 3.865602412858363*^9}, {3.8656025272265215`*^9, 
   3.8656025347665987`*^9}, 3.8656025770823507`*^9, {3.86560403988758*^9, 
   3.865604069547611*^9}, {3.8656054841768537`*^9, 3.8656054912238083`*^9}, {
   3.8656057803525276`*^9, 3.865605816594333*^9}, {3.8656064623443527`*^9, 
   3.8656064710852623`*^9}, {3.865606532685475*^9, 3.865606533233693*^9}, {
   3.86560662901245*^9, 3.865606629319579*^9}, {3.865606709473549*^9, 
   3.865606714498459*^9}, {3.8656070326359205`*^9, 3.865607034180687*^9}, {
   3.8656071268497314`*^9, 3.8656071342480893`*^9}, 3.8660282001608205`*^9, {
   3.866028443359219*^9, 3.8660284439502*^9}, {3.8660287163399935`*^9, 
   3.866028808915395*^9}, {3.8660288764977674`*^9, 3.866028877767373*^9}, {
   3.8660289243199368`*^9, 3.86602893515016*^9}, 3.8660290253641353`*^9, {
   3.8660290963149586`*^9, 3.8660291395596204`*^9}, 3.866029329992544*^9, 
   3.86622189955684*^9, {3.866222084733176*^9, 3.8662220863063154`*^9}, {
   3.933417524244137*^9, 3.933417529623411*^9}, {3.9334175716482134`*^9, 
   3.933417579430935*^9}, {3.9334177147285657`*^9, 3.933417731588671*^9}, {
   3.933417766397001*^9, 3.9334177697863035`*^9}, {3.933417825864032*^9, 
   3.9334178383169374`*^9}, {3.9334178891185274`*^9, 
   3.9334179590598183`*^9}, {3.9334180675368977`*^9, 
   3.9334181080674586`*^9}, {3.933418237442906*^9, 3.9334182527232924`*^9}, {
   3.9334201948526073`*^9, 3.933420258402362*^9}, {3.9336762903240337`*^9, 
   3.9336762937901745`*^9}, {3.933676382495885*^9, 3.9336763993317165`*^9}, {
   3.933676538963855*^9, 3.933676572998973*^9}, {3.933676836415826*^9, 
   3.933676836549213*^9}, {3.933677527573032*^9, 3.9336775791270466`*^9}, {
   3.933677657907074*^9, 3.933677663465037*^9}, {3.9336777137827215`*^9, 
   3.933677724965412*^9}, {3.933677790913623*^9, 3.9336779963002615`*^9}, {
   3.9336782265279336`*^9, 3.9336782415820923`*^9}, 3.9336783747163424`*^9, {
   3.9336787381170936`*^9, 3.9336787715635867`*^9}, {3.933678888878882*^9, 
   3.9336789332406197`*^9}, {3.933678999730237*^9, 3.933679002958905*^9}, {
   3.9336793989925194`*^9, 3.9336794229741373`*^9}, {3.9336912699809427`*^9, 
   3.9336913623037295`*^9}, {3.9336915899609685`*^9, 3.933691627758504*^9}, {
   3.9336923567522383`*^9, 3.9336924009728684`*^9}, {3.933692741518116*^9, 
   3.933692772376129*^9}, {3.9336947420255013`*^9, 3.933694766754877*^9}, {
   3.9336950481695633`*^9, 3.933695048191679*^9}, {3.933696175913248*^9, 
   3.933696183681137*^9}, {3.9336972282960205`*^9, 3.933697228348587*^9}, {
   3.9336980244712567`*^9, 3.9336980354310217`*^9}, {3.933698916082045*^9, 
   3.933698923461434*^9}, {3.9419002734561386`*^9, 3.941900284915487*^9}, {
   3.9419003258883457`*^9, 3.9419003555158873`*^9}, {3.941900504651729*^9, 
   3.9419005175235233`*^9}, {3.9419006010438156`*^9, 3.941900616890976*^9}, {
   3.941900703481121*^9, 3.941900745944589*^9}, {3.9419007923164487`*^9, 
   3.941900823084667*^9}, {3.9419008890827117`*^9, 3.94190090683097*^9}, {
   3.9419009949924536`*^9, 3.9419010084785976`*^9}, {3.941901073819409*^9, 
   3.94190108598147*^9}, {3.9419011980804744`*^9, 3.941901205413772*^9}, {
   3.941901361991343*^9, 3.9419014083690395`*^9}, {3.941901524619605*^9, 
   3.9419015249091873`*^9}, {3.9419046646991224`*^9, 3.941904700042738*^9}, {
   3.942846374842926*^9, 3.9428463763660975`*^9}, {3.9428469892701597`*^9, 
   3.9428470067385387`*^9}, {3.9428471834302273`*^9, 3.942847188305201*^9}, {
   3.942847505646356*^9, 3.942847507549432*^9}, {3.9428478556503005`*^9, 
   3.9428478958739614`*^9}, 3.942848292845415*^9, 3.9433528698750515`*^9, {
   3.9433529076896887`*^9, 3.9433529107803383`*^9}, 3.9433532693241663`*^9, {
   3.9458765549788074`*^9, 3.9458765556837626`*^9}, {3.946972056343913*^9, 
   3.9469720588840632`*^9}, {3.9470751270704656`*^9, 3.9470751574206753`*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"ed15d148-733c-4386-9344-7eadc13d9f93"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Visualization", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"x1range", "=", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.5"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x2range", "=", 
     RowBox[{"{", 
      RowBox[{"0.6", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"referencerange", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0.4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"referenceticks", "=", 
     RowBox[{"FindDivisions", "[", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"referencerange", ",", "0.05"}], "]"}], ",", "9"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x1ticks", "=", 
     RowBox[{"Quiet", "@", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"referenceticks", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{
             RowBox[{"NumberForm", "[", 
              RowBox[{"#", ",", "2"}], "]"}], ",", "StandardForm"}], "]"}], 
           "&"}], "/@", 
          RowBox[{"Rescale", "[", 
           RowBox[{"referenceticks", ",", "referencerange", ",", "x1range"}], 
           "]"}]}]}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x2ticks", "=", 
     RowBox[{"Quiet", "@", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"referenceticks", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "[", 
            RowBox[{
             RowBox[{"NumberForm", "[", 
              RowBox[{"#", ",", "2"}], "]"}], ",", "StandardForm"}], "]"}], 
           "&"}], "/@", 
          RowBox[{"Rescale", "[", 
           RowBox[{"referenceticks", ",", "referencerange", ",", "x2range"}], 
           "]"}]}]}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"extract", "=", 
     RowBox[{"fRateHH", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"extract", "=", 
     RowBox[{"extract", ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"T", "/", "1000"}]}], "}"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g1", "=", " ", 
     RowBox[{"ListDensityPlot", "[", 
      RowBox[{"extract", ",", "\[IndentingNewLine]", 
       RowBox[{"Mesh", "->", "All"}], ",", "\[IndentingNewLine]", 
       RowBox[{"InterpolationOrder", "->", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotLegends", "->", 
        RowBox[{"BarLegend", "[", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "2"}], "}"}]}], "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotLegends", "->", "Automatic"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{"Full", ",", "Full", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotRangeClipping", "->", "False"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ColorFunction", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"ColorData", "[", "\"\<GrayTones\>\"", "]"}], "[", 
           RowBox[{"1", "-", 
            RowBox[{"0.6", "*", 
             RowBox[{
              RowBox[{"Round", "[", 
               RowBox[{"2", "*", "#"}], "]"}], "/", "4"}]}]}], "]"}], "&"}], 
         ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<\[CapitalDelta]C = C0 - C1 (\[Mu]F/cm^2)\>\"", ",", 
            "Automatic"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<\[Kappa]1 = \[Kappa]3 - 0.5\>\"", ",", "None"}], 
           "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"FontSize", "->", "18"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameTicks", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x1ticks", ",", "Automatic"}], "}"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Switch", "[", 
     RowBox[{"case", ",", "\[IndentingNewLine]", "1", ",", 
      RowBox[{
       RowBox[{"pointList", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0.15", ",", "0.2"}], "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0.25", ",", "0.2"}], "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0.15", ",", "0.5"}], "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0.25", ",", "0.5"}], "}"}], "}"}]}], "}"}]}], ";"}], ",",
       "\[IndentingNewLine]", "2", ",", 
      RowBox[{
       RowBox[{"pointList", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0.05", ",", "0.1"}], "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0.25", ",", "0.1"}], "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0.05", ",", "0.145"}], "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0.25", ",", "0.145"}], "}"}], "}"}]}], "}"}]}], ";"}], 
      ",", "\[IndentingNewLine]", "3", ",", 
      RowBox[{
       RowBox[{"pointList", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0.05", ",", "0.1"}], "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0.25", ",", "0.1"}], "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0.05", ",", "0.5"}], "}"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0.25", ",", "0.5"}], "}"}], "}"}]}], "}"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g2", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"pointList", ",", "\[IndentingNewLine]", 
       RowBox[{"PlotMarkers", "->", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<\[FivePointedStar]\>\"", ",", "Blue", ",", "30"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<\[FilledDiamond]\>\"", ",", "Blue", ",", "30"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<\[FilledCircle]\>\"", ",", "Blue", ",", "25"}], "]"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<\[FilledUpTriangle]\>\"", ",", "Blue", ",", "30"}], 
           "]"}]}], "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"g3", "=", 
    RowBox[{"Show", "[", 
     RowBox[{"g1", ",", "g2"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"filename", ",", "g3"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9419013987879887`*^9, 3.941901404332756*^9}, {
   3.9419023710119257`*^9, 3.941902406400489*^9}, {3.941902440900839*^9, 
   3.941902463131772*^9}, {3.942846323267521*^9, 3.942846383453315*^9}, {
   3.94284751690584*^9, 3.9428475557439413`*^9}, {3.942847916130893*^9, 
   3.942847939220235*^9}, {3.9428486365996633`*^9, 3.942848663754505*^9}, {
   3.942849824154225*^9, 3.9428499414693623`*^9}, {3.9428510040753565`*^9, 
   3.942851017066478*^9}, {3.9433529428509817`*^9, 3.943352944713222*^9}, {
   3.9433529803365808`*^9, 3.9433529914389286`*^9}, 3.9433531745455737`*^9, {
   3.9433532143093915`*^9, 3.943353232988718*^9}, {3.9433533087103777`*^9, 
   3.943353328249117*^9}, 3.9458761819850554`*^9, {3.945876439965992*^9, 
   3.945876467944326*^9}, {3.9458770788636723`*^9, 3.9458771281730433`*^9}, {
   3.9458774638785267`*^9, 3.945877491650076*^9}, {3.9458775507119236`*^9, 
   3.9458775978844175`*^9}, {3.9458776816642694`*^9, 
   3.9458777020501595`*^9}, {3.945877745420397*^9, 3.9458778391956673`*^9}, {
   3.945892481389075*^9, 3.945892483395152*^9}, {3.9464717145378094`*^9, 
   3.946471715788498*^9}, {3.9464718594081955`*^9, 3.9464718782284555`*^9}, {
   3.9469720697790823`*^9, 3.9469721005777264`*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"5c17254a-e68d-41e9-a6f9-849a582ba09d"]
},
WindowSize->{1141.2, 568.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>1.1 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"76b16231-a22d-43af-a552-fb81d1ad6400"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 9125, 220, 1078, "Input",ExpressionUUID->"53e0b4d8-0a42-487d-a349-c6b3239d0626",
 InitializationCell->True],
Cell[9686, 242, 29297, 515, 535, "Input",ExpressionUUID->"ed15d148-733c-4386-9344-7eadc13d9f93"],
Cell[38986, 759, 9248, 231, 806, "Input",ExpressionUUID->"5c17254a-e68d-41e9-a6f9-849a582ba09d"]
}
]
*)

